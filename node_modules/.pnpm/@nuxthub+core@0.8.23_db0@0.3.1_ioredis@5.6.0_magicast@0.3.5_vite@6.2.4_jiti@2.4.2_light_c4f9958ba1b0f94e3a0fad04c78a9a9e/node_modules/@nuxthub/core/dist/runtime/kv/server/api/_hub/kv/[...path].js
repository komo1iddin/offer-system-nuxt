import { eventHandler } from "h3";
import { createH3StorageHandler } from "unstorage/server";
import { hubKV } from "../../../utils/kv.js";
import { requireNuxtHubAuthorization } from "../../../../../utils/auth.js";
import { requireNuxtHubFeature } from "../../../../../utils/features.js";
export default eventHandler(async (event) => {
  await requireNuxtHubAuthorization(event);
  requireNuxtHubFeature("kv");
  const storage = hubKV();
  return createH3StorageHandler(storage, {
    resolvePath(event2) {
      return event2.context.params.path || "";
    }
  })(event);
});
